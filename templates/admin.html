<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Admin - AM Jain Chatbot</title>
    <link rel="stylesheet" href="/static/css/style.css">
  </head>
  <body>
    <div class="container p-4">
      <h2>Admin - FAQs</h2>
      <div id="faqs"></div>
      <hr>
      <h3>Add FAQ</h3>
      <input id="q-question" placeholder="Question" style="width:100%"><br><br>
      <textarea id="q-answer" placeholder="Answer (HTML allowed)" style="width:100%;height:120px"></textarea><br><br>
      <input id="q-category" placeholder="Category"> <input id="q-keywords" placeholder="Keywords"><br><br>
      <button id="add-faq" class="btn btn-primary">Add FAQ</button>
    </div>

    <script>
      async function loadFaqs(){
        const res = await fetch('/api/faqs');
        const data = await res.json();
        const container = document.getElementById('faqs');
        container.innerHTML = '';
        data.forEach(f=>{
          const div = document.createElement('div');
          div.className = 'mb-2 p-2 border rounded';
          div.innerHTML = `<div><b>${f.question}</b> <small class="text-muted">${f.category}</small></div><div class="mt-1">${f.answer}</div><div class="mt-2"><button class="btn btn-sm btn-danger" onclick="del(${f.id})">Delete</button></div>`;
          container.appendChild(div);
        })
      }
      async function del(id){
        if(!confirm('Delete this FAQ?')) return;
        await fetch('/api/faqs/'+id, {method:'DELETE'});
        loadFaqs();
      }
      document.getElementById('add-faq').addEventListener('click', async ()=>{
        const question = document.getElementById('q-question').value;
        const answer = document.getElementById('q-answer').value;
        const category = document.getElementById('q-category').value;
        const keywords = document.getElementById('q-keywords').value;
        if(!question || !answer){ alert('Question and answer required'); return; }
        await fetch('/api/faqs', {method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({question, answer, category, keywords})});
        document.getElementById('q-question').value='';
        document.getElementById('q-answer').value='';
        loadFaqs();
      })
      loadFaqs();
    </script>
  </body>
</html>
